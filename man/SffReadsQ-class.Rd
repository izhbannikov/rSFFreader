\name{SffReadsQ-class}
\Rdversion{1.1}
\docType{class}

% Classes
\alias{class:SffReadsQ}
\alias{SffReadsQ-class}
\alias{SffReadsQ}

%Methods
\alias{detail,SffReadsQ-method}
\alias{[,SffReadsQ,ANY,ANY-method}
\alias{[,SffReadsQ,ANY,missing-method}
\alias{[,SffReadsQ,missing,ANY-method}
\alias{[,SffReadsQ,missing,missing-method}
\alias{writeFastaQual,SffReadsQ-method}
\alias{writePhredQual,SffReadsQ-method}
\alias{writePhredQual,FastqQuality-method}
\alias{writeFastq,SffReadsQ,ANY-method}
\alias{quality,ANY-method}
\alias{append,SffReadsQ,SffReadsQ,missing-method}
\alias{quality}
\alias{writeFastaQual}
\alias{writePhredQual}

\title{Class \code{"SffReadsQ"} for next generation reads stored in
SFF files (Roche 454 and Life Sciences Ion Torrent) and their quality scores}

\description{

  SffReadsQ class is a container for storing, next-generation sequencing 
  read data, read id, and sequencing quality information imported directly 
  from SFF files generated by technologies such as Roche 454 and Life 
  Sciences Ion Torrent. This class provides a way to store and manipulate, 
  in a coordinated fashion, next generation reads stored in SFF files, 
  their identifiers and quality scores.

  Objects from this class are the result of \code{\link{readSff}}, or
  can be constructed from \code{DNAStringSet}, \code{QualityScore}, and
  \code{BStringSet} objects, using a call to the
  constructor \code{SffReadsQ}, as described below.
}

\section{Slots}{

  Slot \code{header} is inherited from \code{\linkS4class{SffHeader}}.
  Slots \code{sread}, \code{qualityIR}, \code{adapterIR}, \code{customIR} 
    and \code{clipMode} are inherited from \code{\linkS4class{SffReads}}. 
    An additional slot defined in this class is:
  \describe{
    \item{\code{quality}:}{Object of class \code{"BStringSet"}
      representing a quality score (see \code{\link{readFastq}} for some
      discussion of quality score).}
  }
}
\section{Extends}{
Class \code{"\linkS4class{SffReads}"}, directly.
Class \code{"\linkS4class{SffHeader}"}, by class "SffReads", distance 2.
}
\section{Constructors}{
  \describe{
      \item{SffReadsQ}{\code{sread = "DNAStringSet", quality = "QualityScore", id = "BStringSet"}:}
    \item{SffReadsQ}{\code{sread = "DNAStringSet", quality = "BStringSet", id = "BStringSet"}:
        Create a \code{SffReadsQ} object from reads, their quality
      scores, and identifiers. When \code{quality} is of class
      \code{BStringSet}, the type of encoded quality score is inferred
      from the letters used in the scores. The length of \code{id} and
      \code{quality} must match that of \code{sread}.}

    \item{SffReadsQ}{\code{sread = "DNAStringSet", quality = "QualityScore", id = "missing"}:}
    \item{SffReadsQ}{\code{sread = "DNAStringSet", quality = "BStringSet", id = "missing"}:

      Create a \code{SffReadsQ} object from reads and their quality
      scores, creating empty identifiers. When \code{quality} is of
      class \code{BStringSet}, the type of encoded quality score is
      inferred from the letters used in the scores. }

    \item{SffReadsQ}{\code{sread = "missing", quality = "missing", id = "missing", ...}:
      Create an empty \code{SffReadsQ} object.}
  }
}
\section{Methods}{
  \describe{
    \item{quality}{inherited from \code{signature(object = "ANY")}:
      access the quality slot of \code{object}.}
    \item{[}{\code{signature(x = "SffReads", i = "ANY", j = "missing")}:
      This method creates a new \code{SffReads} object containing only
      those reads indexed by \code{i}. Additional methods on
      \sQuote{[,SffReads} do not provide additional functionality, but
      are present to limit appropriate use.}
    \item{writeFastaQual}{\code{signature(object = "SffReadsQ")}: ... }
    \item{writeFastq}{\code{signature(object = "SffReadsQ", file = "character", mode="character", ...)}:
      Write \code{object} to \code{file} in fastq format. \code{mode}
      defaults to \sQuote{w}. This creates a new file, or fails if
      \code{file} already exists. Use \code{mode="a"} to append to an
      existing file. \code{file} is expanded using \code{path.expand}.}
    \item{writePhredQual}{\code{signature(object = "FastqQuality",  filepath, mode="w")}}
    \item{writePhredQual}{\code{signature(object = "SffReadsQ", filepath, mode="w")}:
      Write \code{object}'s  quality values to \code{filepath} in phred qual format (numeric).
      \code{append} defaults to \sQuote{w}. This creates a new file, or fails if \code{filepath} already exists.
      Use \code{mode="a"} to append to an existing file. \code{filepath} is expanded using \code{path.expand}.}
    \item{writeFastaQual}{\code{signature(object = "SffReadsQ", basefilename = "character", append="logical", ...)}:
      Write \code{object} to \code{basefilename} in fasta and phred qual format. \code{append}
      defaults to \sQuote{FALSE}. This creates a new file, or fails if
      \code{basefilename} already exists. Use \code{append=TRUE} to append to an
      existing file. \code{basefilename} is expanded using \code{path.expand} and 
      the suffixes [basefilename].fasta (sequence) and [basefilename].fasta.qual (qualities) are added.}
    \item{append}{\code{signature(x = "SffReadsQ", values = "SffReads", length = "missing")}:
      append the \code{sread}, \code{quality} and \code{id} slots of
      \code{values} after the corresponding fields of \code{x}.}
   }
}

\author{Matt Settles with lots of code 'borrowed' from Martin Morgan's ShortRead Package}

\seealso{

  \code{\link{readSff}} for creation of objects of this class from
  SFF files.

}
\examples{
showClass("SffReadsQ")
showMethods(class="SffReadsQ", where=getNamespace("rSFFreader"),
            inherit=FALSE)
showMethods(class="SffReads", where=getNamespace("rSFFreader"),
            inherit=FALSE)

sff <- readSff(system.file("extdata","Small454Test.sff",package="rSFFreader"))
quality(sff)

}
\keyword{classes}
